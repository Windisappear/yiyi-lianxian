<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å„¿ç«¥è¿çº¿ç”Ÿæˆå™¨ - é£æ ¼ä¼˜åŒ–ç‰ˆ</title>
    <style id="printOrientation">
        @page { size: A4 portrait; margin: 0; }
    </style>
    <style>
        :root {
            --primary: #4f46e5;
            --text-dark: #0f172a;
            --text-gray: #64748b;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: system-ui, -apple-system, sans-serif; background-color: #cbd5e1; color: var(--text-dark); display: flex; min-height: 100vh; }

        /* --- ä¾§è¾¹æ§åˆ¶é¢æ¿ --- */
        .no-print { width: 320px; background: white; padding: 24px; border-right: 1px solid #e2e8f0; height: 100vh; position: sticky; top: 0; overflow-y: auto; z-index: 100; flex-shrink: 0; }
        h1 { font-size: 20px; font-weight: 900; margin-bottom: 4px; }
        .subtitle { font-size: 11px; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 24px; border-bottom: 1px solid #f1f5f9; padding-bottom: 12px; }
        
        /* å¸ƒå±€æŒ‰é’® */
        .mode-toggle { display: grid; grid-template-cols: 1fr 1fr; background: #f1f5f9; padding: 4px; border-radius: 12px; margin-bottom: 24px; }
        .mode-toggle button { border: none; padding: 12px; border-radius: 8px; font-size: 13px; cursor: pointer; background: transparent; color: var(--text-gray); font-weight: bold; }
        .mode-toggle button.active { background: white; color: var(--primary); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }

        .control-group { margin-bottom: 20px; }
        .control-label { display: block; font-size: 13px; font-weight: bold; color: var(--text-dark); margin-bottom: 8px; }
        select { width: 100%; padding: 12px; border: 2px solid #f1f5f9; border-radius: 12px; outline: none; background: #f8fafc; cursor: pointer; font-size: 14px; }
        input[type="range"] { width: 100%; height: 6px; background: #e2e8f0; border-radius: 5px; outline: none; margin: 15px 0; cursor: pointer; accent-color: var(--primary); }

        .btn { width: 100%; padding: 16px; border-radius: 14px; border: none; font-weight: bold; cursor: pointer; transition: 0.2s; margin-top: 10px; font-size: 15px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-dark { background: var(--text-dark); color: white; }
        .btn-outline { background: white; border: 2px solid var(--text-dark); color: var(--text-dark); }
        
        /* åŒè”é€‰é¡¹æ¡† */
        .dual-box { background: #f5f3ff; padding: 15px; border-radius: 14px; margin-bottom: 20px; border: 1px solid #ede9fe; }

        /* --- A4 é¢„è§ˆå®¹å™¨ --- */
        .preview-area { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 40px; overflow-y: auto; gap: 40px; }
        .a4-page { background: white; box-shadow: 0 20px 40px rgba(0,0,0,0.1); display: flex; position: relative; break-after: page; page-break-after: always; }
        .a4-page.portrait { width: 210mm; height: 297mm; flex-direction: column; }
        .a4-page.landscape { width: 297mm; height: 210mm; flex-direction: row; }

        /* --- ç»ƒä¹ ç”ŸæˆåŒº --- */
        .exercise-zone { flex: 1; height: 100%; padding: 20mm 15mm; display: flex; flex-direction: column; }
        .match-container { flex: 1; display: flex; justify-content: space-between; align-items: stretch; width: 100%; }
        .column { display: flex; flex-direction: column; justify-content: space-around; align-items: center; width: 30%; }
        
        .shape-card { background: white; border: 2px solid #f1f5f9; display: flex; align-items: center; justify-content: center; position: relative; }
        .portrait .shape-card { width: 110px; height: 110px; border-radius: 24px; }
        .landscape .shape-card { width: 85px; height: 85px; border-radius: 18px; }

        .dot { width: 18px; height: 18px; border: 2.5px solid #000; border-radius: 50%; background: white; position: absolute; top: 50%; margin-top: -9px; z-index: 10; }
        .dot-left { right: -35px; }
        .dot-right { left: -35px; }
        .landscape .dot { width: 15px; height: 15px; margin-top: -7.5px; }

        .split-line { width: 0; height: 100%; border-left: 2px dashed #cbd5e1; position: relative; }
        .split-line::after { content: "è£å‰ªçº¿"; position: absolute; top: 50%; left: -20px; transform: rotate(-90deg); background: white; padding: 0 10px; font-size: 10px; color: #94a3b8; }

        @media print {
            .no-print { display: none !important; }
            body { background: white; margin: 0; padding: 0; }
            .preview-area { padding: 0; display: block; }
            .a4-page { box-shadow: none; margin: 0 auto; border: none; }
        }
    </style>
</head>
<body>
    <div class="no-print">
        <h1>è¿çº¿ç”Ÿæˆå™¨</h1>
        <p class="subtitle">Style Optimized V3.2</p>

        <div class="mode-toggle">
            <button id="btnSingle" class="active" onclick="changeLayout('single')">å•é¡µæ¨¡å¼</button>
            <button id="btnDual" onclick="changeLayout('dual')">åŒè”(æ¨ªå‘)</button>
        </div>

        <div class="control-group">
            <span class="control-label" id="lblTheme1">ä¸»é¢˜ç³»åˆ—</span>
            <select id="selectCat1" onchange="generate(1)"></select>
        </div>

        <div id="dualOptions" class="dual-box" style="display: none;">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                <span style="font-size: 13px; font-weight: bold; color: #5b21b6;">å·¦å³ä¸»é¢˜ä¸åŒ</span>
                <input type="checkbox" id="checkDiff" onchange="toggleDiffTheme()" style="width: 18px; height: 18px; cursor: pointer;">
            </div>
            <div id="theme2Group" style="display: none;">
                <label class="control-label" style="font-size: 11px; color: #7c3aed;">å³ä¾§ä¸»é¢˜</label>
                <select id="selectCat2" onchange="generate(1)"></select>
            </div>
        </div>

        <div class="control-group">
            <span class="control-label" id="lblCountText">æ¯é¡µå›¾å½¢æ•°é‡: 6</span>
            <input type="range" id="rangeCount" min="3" max="6" value="6" oninput="updateCount(this.value)">
        </div>

        <button class="btn btn-dark" onclick="generate(1)">ğŸ”„ ç”Ÿæˆå½“å‰é¡µ</button>
        <button class="btn btn-primary" onclick="generate(10)">ğŸ“š ä¸€é”®ç”Ÿæˆ 10 é¡µ</button>
        <button class="btn btn-outline" onclick="window.print()">ğŸ–¨ï¸ æ‰“å°å…¨éƒ¨ PDF</button>
    </div>

    <div class="preview-area" id="printWrapper"></div>

    <script>
        // --- å›¾å½¢æ•°æ®åº“ (å·²æ›´æ–°) ---
        const SHAPES = {
            geometry: [
                { id: 'g1', paths: ["M50 15 L90 85 L10 85 Z"] }, // ä¸‰è§’å½¢
                { id: 'g2', paths: ["M20 20 H80 V80 H20 Z"] }, // æ­£æ–¹å½¢
                { id: 'g3', paths: ["M50 10 A 40 40 0 1 1 50 90 A 40 40 0 1 1 50 10 Z"] }, // åœ†å½¢
                { id: 'g4', paths: ["M50 5 L63 35 L95 35 L70 55 L80 85 L50 70 L20 85 L30 55 L5 35 L37 35 Z"] }, // æ˜Ÿå½¢
                { id: 'g5', paths: ["M50 85 C10 65 10 35 50 35 C90 35 90 65 50 85"] }, // çˆ±å¿ƒ
                { id: 'g6', paths: ["M50 10 L90 40 L75 90 L25 90 L10 40 Z"] } // æ–°å¢ï¼šäº”è¾¹å½¢
            ],
            numbers: [1,2,3,4,5,6,7,8,9].map(n => ({ id:'n'+n, content: n, isText: true })),
            letters: "ABCDEFGHJKLMNPQRSTUVWXYZ".split("").map(l => ({ id:'l'+l, content: l, isText: true })),
            // ä»¥ä¸‹ç³»åˆ—å·²æ›¿æ¢ä¸ºæ‚¨æä¾›çš„æ—§ç‰ˆé£æ ¼æ•°æ®
            animals: [
                { id: 'a1', paths: ["M40 70 H25 L15 85", "M80 70 C65 70 60 55 60 55 S55 70 40 70", "M80 30 C80 15 65 5 50 5 S20 15 20 30 V50 C20 55 25 60 35 60 H75 C80 60 85 55 85 50 V30", "M20 30 C10 30 5 40 5 50 S10 65 20 65"] },
                { id: 'a2', paths: ["M20 12 S35 5 50 5 S80 12 80 30 V80 H20 V30", "M35 30 A 2 2 0 1 1 35.1 30", "M65 30 A 2 2 0 1 1 65.1 30", "M40 55 Q 50 65 60 55"] },
                { id: 'a3', paths: ["M10 50 A 40 35 0 1 0 90 50 L 10 50 Z", "M75 50 V 15 L 60 30", "M25 50 V 15 L 40 30"] },
                { id: 'a4', paths: ["M15 60 Q 30 40 50 40 Q 70 40 85 60 L 50 85 Z", "M40 45 Q 50 30 60 45", "M50 45 V 35 L 65 40"] }
            ],
            plants: [
                { id: 'p1', paths: ["M50 25 C30 5 10 25 30 45 C10 65 30 85 50 65 C70 85 90 65 70 45 C90 25 70 5 50 25 Z"] },
                { id: 'p2', paths: ["M45 85 V 55", "M55 85 V 55", "M30 55 L 50 25 L 70 55 Z"] },
                { id: 'p3', paths: ["M50 15 C 20 30 20 70 50 85 C 80 70 80 30 50 15 Z", "M 50 15 V 85"] },
                { id: 'p4', paths: ["M35 70 H65 L60 85 H40 Z", "M35 70 V40 C35 20 65 20 65 40 V70"] },
                { id: 'p5', paths: ["M50 85 V55", "M35 55 C20 30 40 30 50 50 C60 30 80 30 65 55 Z"] },
                { id: 'p6', paths: ["M50 80 V60", "M30 60 C30 30 70 30 70 60 Z", "M35 60 C35 45 65 45 65 60"] }
            ],
            clothing: [
                { id: 'c1', paths: ["M30 20 L20 30 V45 H30 V85 H70 V45 H80 V30 L70 20 L50 25 Z"] },
                { id: 'c2', paths: ["M35 20 H65 L80 85 H20 Z", "M50 20 V35"] },
                { id: 'c3', paths: ["M25 40 C25 10 75 10 75 40 H25 Z", "M20 40 H80"] },
                { id: 'c4', paths: ["M35 20 H50 V60 C50 75 70 75 70 85 H35 V20 Z"] },
                { id: 'c5', paths: ["M30 30 H70 L65 70 H55 L50 55 L45 70 H35 L30 30 Z"] },
                { id: 'c6', paths: ["M35 80 V60 C35 40 40 30 50 30 C60 30 65 40 65 60 V80 H35 Z"] }
            ],
            vehicles: [
                { id: 'v1', paths: ["M15 55 L25 35 H75 L85 55 V75 H15 Z", "M30 75 A 8 8 0 1 0 30.1 75", "M70 75 A 8 8 0 1 0 70.1 75"] },
                { id: 'v2', paths: ["M20 45 L80 45 L95 50 L80 55 L20 55 L5 50 Z", "M40 45 V25 L60 45", "M40 55 V75 L60 55"] },
                { id: 'v3', paths: ["M25 65 H75 L70 85 H30 Z", "M50 60 V20 L75 60 H50 Z"] },
                { id: 'v4', paths: ["M50 20 C40 30 40 60 40 80 H60 C60 60 60 30 50 20 Z", "M40 70 L30 80", "M60 70 L70 80"] },
                { id: 'v5', paths: ["M20 40 H80 V70 H20 Z", "M25 70 A 5 5 0 1 0 25.1 70", "M75 70 A 5 5 0 1 0 75.1 70"] },
                { id: 'v6', paths: ["M30 55 A 15 15 0 1 0 30.1 55", "M70 55 A 15 15 0 1 0 70.1 55", "M30 55 H70"] }
            ],
            furniture: [
                { id: 'u1', paths: ["M30 80 V40 H70 V80", "M30 60 H70", "M35 40 V20 H65 V40"] },
                { id: 'u2', paths: ["M30 85 V75 H70 V85", "M50 75 V35", "M30 35 L50 15 L70 35 Z"] },
                { id: 'u3', paths: ["M20 50 V80 H80 V50 H20 Z", "M20 65 H80", "M30 50 V30 H70 V50"] },
                { id: 'u4', paths: ["M25 35 H75 V55 H25 Z", "M30 55 V75", "M70 55 V75"] },
                { id: 'u5', paths: ["M20 50 H80 V75 H20 Z", "M25 75 V80", "M75 75 V80"] },
                { id: 'u6', paths: ["M50 50 M 20 50 A 30 30 0 1 1 80 50 A 30 30 0 1 1 20 50 Z"] }
            ]
        };

        const CATEGORIES = [
            { id: 'geometry', name: 'ğŸ”º å‡ ä½•å½¢çŠ¶' },
            { id: 'numbers', name: '1ï¸âƒ£ æ•°å­—å­¦ä¹ ' },
            { id: 'letters', name: 'ğŸ”  è‹±æ–‡å­—æ¯' },
            { id: 'animals', name: 'ğŸ¦ åŠ¨ç‰©ä¸–ç•Œ' },
            { id: 'plants', name: 'ğŸŒ³ æ¤ç‰©èŠ±å‰' },
            { id: 'clothing', name: 'ğŸ‘• æœè£…ç©¿æ­' },
            { id: 'vehicles', name: 'ğŸš— äº¤é€šå·¥å…·' },
            { id: 'furniture', name: 'ğŸª‘ å®¶å…·ç”Ÿæ´»' }
        ];

        let currentLayout = 'single';
        let useDiffThemes = false;
        // ç”±äºå¤§éƒ¨åˆ†å…·è±¡åˆ†ç±»åªæœ‰4-6ä¸ªå›¾å½¢ï¼Œå°†æœ€å¤§å€¼è°ƒæ•´ä¸º 6 ä»¥ä¿è¯ç¨³å®šè¿è¡Œ
        let currentCount = 6; 

        function init() {
            const s1 = document.getElementById('selectCat1');
            const s2 = document.getElementById('selectCat2');
            CATEGORIES.forEach(c => {
                const opt = `<option value="${c.id}">${c.name}</option>`;
                s1.innerHTML += opt;
                s2.innerHTML += opt;
            });
            s2.value = 'numbers';
            // åˆå§‹åŒ–æ—¶æ›´æ–°æ»‘åŠ¨æ¡æœ€å¤§å€¼
            document.getElementById('rangeCount').max = 6;
            generate(1);
        }

        function changeLayout(mode) {
            currentLayout = mode;
            document.getElementById('btnSingle').className = mode === 'single' ? 'active' : '';
            document.getElementById('btnDual').className = mode === 'dual' ? 'active' : '';
            document.getElementById('dualOptions').style.display = mode === 'dual' ? 'block' : 'none';
            const style = document.getElementById('printOrientation');
            style.innerHTML = `@page { size: A4 ${mode === 'single' ? 'portrait' : 'landscape'}; margin: 0; }`;
            generate(1);
        }

        function toggleDiffTheme() {
            useDiffThemes = document.getElementById('checkDiff').checked;
            document.getElementById('theme2Group').style.display = useDiffThemes ? 'block' : 'none';
            generate(1);
        }

        function updateCount(val) {
            currentCount = parseInt(val);
            document.getElementById('lblCountText').innerText = `æ¯é¡µå›¾å½¢æ•°é‡: ${val}`;
            generate(1);
        }

        function shuffle(arr) { return [...arr].sort(() => Math.random() - 0.5); }

        function getShapeHTML(item) {
            if (item.isText) return `<text x="50" y="52" dominant-baseline="middle" text-anchor="middle" font-size="65" font-weight="900" fill="none" stroke="black" stroke-width="2">${item.content}</text>`;
            // ç»Ÿä¸€ä½¿ç”¨2.5åƒç´ çš„æè¾¹å®½åº¦
            return item.paths.map(d => `<path d="${d}" fill="none" stroke="black" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />`).join('');
        }

        function createZone(catId) {
            const source = SHAPES[catId] || SHAPES.geometry;
            // ç¡®ä¿è¯·æ±‚æ•°é‡ä¸è¶…è¿‡å½“å‰åˆ†ç±»å®é™…æ‹¥æœ‰çš„æ•°é‡
            const actualCount = Math.min(currentCount, source.length);
            const selection = shuffle(source).slice(0, actualCount);
            const leftSet = [...selection];
            const rightSet = shuffle(selection);

            const sL = leftSet.map(i => `<div class="shape-card"><svg viewBox="0 0 100 100" style="width:75%; height:75%; overflow:visible;">${getShapeHTML(i)}</svg><div class="dot dot-left"></div></div>`).join('');
            const sR = rightSet.map(i => `<div class="shape-card"><div class="dot dot-right"></div><svg viewBox="0 0 100 100" style="width:75%; height:75%; overflow:visible;">${getShapeHTML(i)}</svg></div>`).join('');

            return `<div class="exercise-zone"><div class="match-container"><div class="column">${sL}</div><div class="column">${sR}</div></div></div>`;
        }

        function generate(pageNum) {
            const wrapper = document.getElementById('printWrapper');
            const cat1 = document.getElementById('selectCat1').value;
            const cat2 = document.getElementById('selectCat2').value;
            
            let html = "";
            for (let i = 0; i < pageNum; i++) {
                html += `<div class="a4-page ${currentLayout === 'single' ? 'portrait' : 'landscape'}">`;
                if (currentLayout === 'single') {
                    html += createZone(cat1);
                } else {
                    const rightTheme = useDiffThemes ? cat2 : cat1;
                    html += createZone(cat1) + '<div class="split-line"></div>' + createZone(rightTheme);
                }
                html += `</div>`;
            }
            wrapper.innerHTML = html;
        }

        window.onload = init;
    </script>
</body>
</html>